
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Data Version Control - AI Engineer Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#ab47bd">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="purple" data-md-color-accent="">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-version-control" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="AI Engineer Guide" class="md-header-nav__button md-logo" aria-label="AI Engineer Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            AI Engineer Guide
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Data Version Control
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/mapattacker/ai-engineer/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mapattacker/ai-engineer
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AI Engineer Guide" class="md-nav__button md-logo" aria-label="AI Engineer Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    AI Engineer Guide
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mapattacker/ai-engineer/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mapattacker/ai-engineer
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../virtual_env/" class="md-nav__link">
      Virtual Environment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../git/" class="md-nav__link">
      Code Version Control
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Data Version Control
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Data Version Control
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dvc-init" class="md-nav__link">
    DVC INIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-s3-keys" class="md-nav__link">
    Add S3 Keys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-remote-link" class="md-nav__link">
    Add Remote Link
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-data-to-s3" class="md-nav__link">
    Push Data to S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-git" class="md-nav__link">
    Update Git
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieve-data-from-s3" class="md-nav__link">
    Retrieve Data from S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-code-example" class="md-nav__link">
    Full Code Example
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mlflow/" class="md-nav__link">
      Model Version
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../code-standards/" class="md-nav__link">
      Code Standards
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../security/" class="md-nav__link">
      Security
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../model-opt/" class="md-nav__link">
      Model Optimization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../flask/" class="md-nav__link">
      Flask
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tf-serving/" class="md-nav__link">
      Tensorflow Serving
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../test/" class="md-nav__link">
      Testing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../test-other/" class="md-nav__link">
      Other Tests
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../serverless/" class="md-nav__link">
      Serverless
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../demo/" class="md-nav__link">
      Demo Site
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../monitoring/" class="md-nav__link">
      Monitoring
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cicd/" class="md-nav__link">
      CI/CD
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dvc-init" class="md-nav__link">
    DVC INIT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-s3-keys" class="md-nav__link">
    Add S3 Keys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-remote-link" class="md-nav__link">
    Add Remote Link
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-data-to-s3" class="md-nav__link">
    Push Data to S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-git" class="md-nav__link">
    Update Git
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieve-data-from-s3" class="md-nav__link">
    Retrieve Data from S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-code-example" class="md-nav__link">
    Full Code Example
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mapattacker/ai-engineer/edit/master/docs/dvc.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="data-version-control">Data Version Control</h1>
<p><a href="https://dvc.org">DVC</a> is a library for ML versioning of blobs, which can include data and/or models. For this documentation, we will be using an example where we store the data versions into AWS S3 bucket. To start off, install the dvc library, together with AWS S3's accompanying library </p>
<div class="codehilite"><pre><span></span><code>pip install dvc<span class="o">[</span>s3<span class="o">]</span>
</code></pre></div>


<h2 id="dvc-init">DVC INIT</h2>
<p><code>dvc init</code> will add a <code>.dvcignore</code> file, and more importantly, a <code>.dvc</code> folder. Within the latter, it contains: </p>
<ul>
<li><code>cache</code> folder: stores the data versions &amp; corresponding hashes, which will be uploaded to the S3. These will not be uploaded to the repository, as there is a <code>.gitignore</code> file automatically created, that excludes this folder.</li>
<li><code>config</code> file: stores the s3 bucket URLs</li>
</ul>
<h2 id="add-s3-keys">Add S3 Keys</h2>
<p>To allow DVC to push &amp; pull data via S3 bucket, we need to set the AWS Access &amp; Secret Keys, either through AWS CLI <code>aws configure</code>, or save them as environment variables in the OS.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">export</span> <span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;xxx&quot;</span>
<span class="nb">export</span> <span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">&quot;xxx&quot;</span>
</code></pre></div>


<h2 id="add-remote-link">Add Remote Link</h2>
<p>We then add the remote links, by giving it a name, and the S3 URL. You can see that we are classifying the links as folders within an S3 bucket</p>
<div class="codehilite"><pre><span></span><code>dvc remote add babystroller s3://images/babystroller
dvc remote add rubbishbin s3://images/rubbishbin
<span class="c1"># add as a default remote</span>
dvc remote add -d safetycone s3://images/safetycone
</code></pre></div>


<p>This will update the <code>.dvc/config</code> file as shown below.</p>
<div class="codehilite"><pre><span></span><code><span class="k">[core]</span>
    <span class="na">remote</span> <span class="o">=</span> <span class="s">safetycone</span>
<span class="k">[&#39;remote &quot;babystroller&quot;&#39;]</span>
    <span class="na">url</span> <span class="o">=</span> <span class="s">s3://images/babystroller</span>
<span class="k">[&#39;remote &quot;safetycone&quot;&#39;]</span>
    <span class="na">url</span> <span class="o">=</span> <span class="s">s3://images/safetycone</span>
<span class="k">[&#39;remote &quot;rubbishbin&quot;&#39;]</span>
    <span class="na">url</span> <span class="o">=</span> <span class="s">s3://images/rubbishbin</span>
</code></pre></div>


<h2 id="push-data-to-s3">Push Data to S3</h2>
<p>We create a folder and add the datasets in there. This will create a version of the data. The details are as follows:</p>
<ul>
<li>Add folder <foldername> with data</li>
<li><code>dvc add &lt;foldername&gt;</code></li>
<li>a file called <code>&lt;foldername&gt;.dvc</code> will be created</li>
<li><code>.dvc/cache</code> folder containing the data version &amp; hashes will be created</li>
<li>the <code>&lt;foldername&gt;</code> is automatically added to <code>.gitignore</code> so that the data will not be uploaded to the repository</li>
<li>Push data version to S3: <code>dvc push -r &lt;remote name&gt; &lt;foldername&gt;.dvc</code></li>
</ul>
<p>We need to be mindful to set the remote name to the correct link else it will just use the default (core) link.</p>
<h2 id="update-git">Update Git</h2>
<p>We then git commit the <code>&lt;foldername&gt;.dvc</code>, <code>.gitignore</code> &amp; <code>.dvc/config</code> (if there are any additions of the remote links) to the repository. The git commit message/hash will be the basis to access the data version.</p>
<h2 id="retrieve-data-from-s3">Retrieve Data from S3</h2>
<p>We can pull from specific dvc folders by using <code>dvc pull -r &lt;remote name&gt; &lt;foldername&gt;.dvc</code></p>
<h2 id="full-code-example">Full Code Example</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># add remote link</span>
dvc remote add rubbishbin s3://images/rubbishbin

<span class="c1"># assume folder called rubbishbin is added with data inside</span>
<span class="c1"># store data version to S3</span>
dvc add rubbishbin
dvc push -r rubbishbin rubbishbin.dvc

<span class="c1"># git commit</span>
git add rubbishbin.dvc .dvc/config .gitignore
git commit -m <span class="s2">&quot;Add init rubbishbin dataset&quot;</span>
git push

<span class="c1"># pull data</span>
dvc pull -r rubbishbin rubbishbin.dvc
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../git/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Code Version Control
              </div>
            </div>
          </a>
        
        
          <a href="../mlflow/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Model Version
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>